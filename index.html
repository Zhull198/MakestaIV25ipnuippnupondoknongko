<!DOCTYPE html>
<html lang="id" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pendaftaran Makesta IV 2025 - PR IPNU-IPPNU Pondoknongko</title>
    
    <!-- Tailwind CSS via CDN for rapid styling -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Google Fonts: Exo 2 for Display, Quicksand for Body -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Exo+2:wght@700;800&family=Quicksand:wght@400;600;700&display=swap" rel="stylesheet">
    
    <!-- Custom Tailwind Configuration for the "Aurora" color scheme and new fonts -->
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'navy-dark': '#0D1128',
                        'teal-glow': '#14B8A6',
                        'cyan-glow': '#06B6D4',
                        'magenta-glow': '#EC4899',
                        'lime-glow': '#A3E635',
                        'light-text': '#E5E7EB',
                    },
                    fontFamily: {
                        'display': ['"Exo 2"', 'sans-serif'],
                        'body': ['Quicksand', 'sans-serif']
                    }
                }
            }
        }
    </script>

    <!-- Custom CSS for animations, glows, and the aurora background -->
    <style>
        @keyframes aurora {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        .aurora-header {
            background: linear-gradient(125deg, #0D1128, #1e293b, #3730a3, #14B8A6, #EC4899, #0D1128);
            background-size: 400% 400%;
            animation: aurora 15s ease infinite;
        }

        /* Base state for animated sections */
        .fade-in-section {
            opacity: 0;
            transform: translateY(30px);
            transition: opacity 0.8s ease-out, transform 0.8s ease-out;
        }
        .fade-in-section.is-visible {
            opacity: 1;
            transform: translateY(0);
        }

        /* Glowing text and button effects */
        .text-glow {
            text-shadow: 0 0 8px rgba(236, 72, 153, 0.5), 0 0 20px rgba(163, 230, 53, 0.3);
        }
        
        .button-glow {
            box-shadow: 0 0 15px rgba(20, 184, 166, 0.4), 0 0 30px rgba(6, 182, 212, 0.3);
            transition: all 0.3s ease-in-out;
        }
        .button-glow:hover {
            transform: scale(1.05);
            box-shadow: 0 0 25px rgba(20, 184, 166, 0.7), 0 0 50px rgba(6, 182, 212, 0.5);
        }
        
        .card-glow {
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
            background-color: rgba(30, 41, 59, 0.5);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        .card-glow:hover {
            transform: translateY(-8px);
            box-shadow: 0 0 20px rgba(236, 72, 153, 0.3);
            border-color: rgba(236, 72, 153, 0.5);
        }

        /* Loading spinner */
        .loader {
            border: 4px solid rgba(255,255,255,0.2);
            border-top: 4px solid #A3E635;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        /* Logo Animation */
        .logo-container {
            transition: transform 0.4s ease-in-out;
        }
        .logo-container:hover {
            transform: rotate(10deg) scale(1.05);
        }
    </style>
</head>
<body class="font-body bg-navy-dark text-light-text">

    <!-- =========== HEADER SECTION --- LOGO UPDATED =========== -->
    <header class="aurora-header text-white text-center py-20 px-6 overflow-hidden">
        <div class="max-w-4xl mx-auto flex flex-col items-center">
            <!-- Logo Container -->
            <div class="logo-container mb-8 w-40 h-40 md:w-48 md:h-48 mx-auto rounded-full p-1 bg-white/10 backdrop-blur-sm border-2 border-solid border-cyan-glow/50 overflow-hidden">
                <!-- PENTING: Ganti 'src' dengan path logo Anda, contoh: "Gambar/5.png". Saya menggunakan placeholder. -->
                <img src="Gambar/5.png" 
                     alt="Logo Makesta IV" 
                     class="w-full h-full object-cover rounded-full">
            </div>
            <h1 class="font-display text-4xl md:text-6xl font-bold text-glow uppercase tracking-wider">Makesta IV 2025</h1>
            <p class="mt-4 text-lg md:text-2xl max-w-3xl mx-auto">Reaktualisasi Peran Pelajar NU Menuju Indonesia Emas 2045</p>
        </div>
    </header>

    <!-- Main Content Wrapper -->
    <main class="container mx-auto px-6 py-16 md:py-24 space-y-20 md:space-y-32">
        
        <!-- =========== FACILITIES SECTION =========== -->
        <section id="facilities" class="fade-in-section">
            <h2 class="font-display text-3xl md:text-4xl font-bold text-center mb-12 uppercase">Fasilitas Peserta</h2>
            <div class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-6 md:gap-8 text-center">
                <!-- Facility Items -->
                <div class="p-6 rounded-2xl card-glow"><div class="flex justify-center items-center w-20 h-20 mx-auto bg-cyan-glow/10 rounded-full"><svg class="w-10 h-10 text-cyan-glow" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"></path></svg></div><h3 class="mt-4 font-semibold">Kartu Identitas</h3></div>
                <div class="p-6 rounded-2xl card-glow"><div class="flex justify-center items-center w-20 h-20 mx-auto bg-cyan-glow/10 rounded-full"><svg class="w-10 h-10 text-cyan-glow" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 14v3m4-3v3m4-3v3M3 21h18M3 10h18M3 7l9-4 9 4M4 10h16v11H4V10z"></path></svg></div><h3 class="mt-4 font-semibold">Ruangan Istirahat</h3></div>
                <div class="p-6 rounded-2xl card-glow"><div class="flex justify-center items-center w-20 h-20 mx-auto bg-cyan-glow/10 rounded-full"><svg class="w-10 h-10 text-cyan-glow" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 15.546c-.523 0-1.046.151-1.5.454a2.704 2.704 0 01-3 0 2.704 2.704 0 00-3 0 2.704 2.704 0 01-3 0 2.704 2.704 0 00-3 0c-.454-.303-.977-.454-1.5-.454V8.546c.523 0 1.046-.151 1.5-.454a2.704 2.704 0 013 0 2.704 2.704 0 003 0 2.704 2.704 0 013 0 2.704 2.704 0 003 0c.454.303.977.454 1.5.454v7z"></path></svg></div><h3 class="mt-4 font-semibold">Konsumsi Peserta</h3></div>
                <div class="p-6 rounded-2xl card-glow"><div class="flex justify-center items-center w-20 h-20 mx-auto bg-cyan-glow/10 rounded-full"><svg class="w-10 h-10 text-cyan-glow" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"></path></svg></div><h3 class="mt-4 font-semibold">Sertifikat Makesta</h3></div>
                <div class="p-6 rounded-2xl card-glow"><div class="flex justify-center items-center w-20 h-20 mx-auto bg-cyan-glow/10 rounded-full"><svg class="w-10 h-10 text-cyan-glow" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M12 6.042A8.967 8.967 0 006 3.75c-1.052 0-2.062.18-3 .512v14.25A8.987 8.987 0 016 18c2.305 0 4.408.867 6 2.292m0-14.25a8.966 8.966 0 016-2.292c1.052 0 2.062.18 3 .512v14.25A8.987 8.987 0 0018 18a8.967 8.967 0 00-6 2.292m0-14.25v14.25" /></svg></div><h3 class="mt-4 font-semibold">Ilmu Bermanfaat</h3></div>
                <div class="p-6 rounded-2xl card-glow"><div class="flex justify-center items-center w-20 h-20 mx-auto bg-cyan-glow/10 rounded-full"><svg class="w-10 h-10 text-cyan-glow" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.653-.28-1.25-.743-1.674M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 0c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"></path></svg></div><h3 class="mt-4 font-semibold">Relasi & Teman Baru</h3></div>
            </div>
        </section>

        <!-- =========== EVENT RUNDOWN (TIMELINE) SECTION --- UPDATED =========== -->
        <section id="rundown" class="fade-in-section">
            <h2 class="font-display text-3xl md:text-4xl font-bold text-center mb-12 uppercase">Rundown Acara</h2>
            <div class="max-w-3xl mx-auto grid md:grid-cols-2 gap-x-12 gap-y-10">
                <!-- Day 1 Timeline -->
                <div>
                    <h3 class="font-display text-2xl font-bold mb-6 text-center md:text-left text-lime-glow">ðŸ“… Sabtu, 12 Juli 2025</h3>
                    <div class="relative border-l-2 border-teal-glow/50 ml-4 md:ml-0">
                        <!-- Timeline Items for Day 1 -->
                        <div class="mb-8 pl-10 relative"><div class="absolute -left-[10px] top-1 w-5 h-5 bg-teal-glow rounded-full border-2 border-navy-dark" style="box-shadow: 0 0 10px #14B8A6;"></div><p class="font-semibold text-lg">Registrasi & Pra Acara</p><p class="text-sm text-light-text/70">08.00â€“09.00</p></div>
                        <div class="mb-8 pl-10 relative"><div class="absolute -left-[10px] top-1 w-5 h-5 bg-teal-glow rounded-full border-2 border-navy-dark" style="box-shadow: 0 0 10px #14B8A6;"></div><p class="font-semibold text-lg">Seremonial Pembukaan</p><p class="text-sm text-light-text/70">09.00â€“10.30</p></div>
                        <div class="mb-8 pl-10 relative"><div class="absolute -left-[10px] top-1 w-5 h-5 bg-teal-glow rounded-full border-2 border-navy-dark" style="box-shadow: 0 0 10px #14B8A6;"></div><p class="font-semibold text-lg">Kontrak Forum</p><p class="text-sm text-light-text/70">10.30â€“11.00</p></div>
                        <div class="mb-8 pl-10 relative"><div class="absolute -left-[10px] top-1 w-5 h-5 bg-teal-glow rounded-full border-2 border-navy-dark" style="box-shadow: 0 0 10px #14B8A6;"></div><p class="font-semibold text-lg">Ishoma</p><p class="text-sm text-light-text/70">11.00â€“11.45</p></div>
                        <div class="mb-8 pl-10 relative"><div class="absolute -left-[10px] top-1 w-5 h-5 bg-teal-glow rounded-full border-2 border-navy-dark" style="box-shadow: 0 0 10px #14B8A6;"></div><p class="font-semibold text-lg">Materi: Ke-Aswajaan, Ke-NU-an, Ke-IPNU-an</p><p class="text-sm text-light-text/70">11.45â€“14.45</p></div>
                        <div class="mb-8 pl-10 relative"><div class="absolute -left-[10px] top-1 w-5 h-5 bg-teal-glow rounded-full border-2 border-navy-dark" style="box-shadow: 0 0 10px #14B8A6;"></div><p class="font-semibold text-lg">Istirahat Salat</p><p class="text-sm text-light-text/70">14.45â€“15.15</p></div>
                        <div class="mb-8 pl-10 relative"><div class="absolute -left-[10px] top-1 w-5 h-5 bg-teal-glow rounded-full border-2 border-navy-dark" style="box-shadow: 0 0 10px #14B8A6;"></div><p class="font-semibold text-lg">Materi: Ke-Indonesia-an & Keorganisasian</p><p class="text-sm text-light-text/70">15.15â€“17.15</p></div>
                        <div class="mb-8 pl-10 relative"><div class="absolute -left-[10px] top-1 w-5 h-5 bg-teal-glow rounded-full border-2 border-navy-dark" style="box-shadow: 0 0 10px #14B8A6;"></div><p class="font-semibold text-lg">Istirahat Salat & Istigasah</p><p class="text-sm text-light-text/70">17.15â€“18.15</p></div>
                        <div class="mb-8 pl-10 relative"><div class="absolute -left-[10px] top-1 w-5 h-5 bg-teal-glow rounded-full border-2 border-navy-dark" style="box-shadow: 0 0 10px #14B8A6;"></div><p class="font-semibold text-lg">Materi Kepemimpinan</p><p class="text-sm text-light-text/70">18.15â€“19.15</p></div>
                        <div class="mb-8 pl-10 relative"><div class="absolute -left-[10px] top-1 w-5 h-5 bg-teal-glow rounded-full border-2 border-navy-dark" style="box-shadow: 0 0 10px #14B8A6;"></div><p class="font-semibold text-lg">Pentas Seni</p><p class="text-sm text-light-text/70">20.00â€“22.00</p></div>
                        <div class="mb-8 pl-10 relative"><div class="absolute -left-[10px] top-1 w-5 h-5 bg-teal-glow rounded-full border-2 border-navy-dark" style="box-shadow: 0 0 10px #14B8A6;"></div><p class="font-semibold text-lg">Pembaiatan</p><p class="text-sm text-light-text/70">00.30â€“04.00</p></div>
                    </div>
                </div>
                 <!-- Day 2 Timeline -->
                 <div>
                    <h3 class="font-display text-2xl font-bold mb-6 text-center md:text-left text-lime-glow">ðŸ“… Minggu, 13 Juli 2025</h3>
                    <div class="relative border-l-2 border-teal-glow/50 ml-4 md:ml-0">
                        <!-- Timeline Items for Day 2 -->
                        <div class="mb-8 pl-10 relative"><div class="absolute -left-[10px] top-1 w-5 h-5 bg-teal-glow rounded-full border-2 border-navy-dark" style="box-shadow: 0 0 10px #14B8A6;"></div><p class="font-semibold text-lg">Salat Subuh</p><p class="text-sm text-light-text/70">04.00â€“05.00</p></div>
                        <div class="mb-8 pl-10 relative"><div class="absolute -left-[10px] top-1 w-5 h-5 bg-teal-glow rounded-full border-2 border-navy-dark" style="box-shadow: 0 0 10px #14B8A6;"></div><p class="font-semibold text-lg">Fun Game & Sarapan</p><p class="text-sm text-light-text/70">06.00â€“07.00</p></div>
                        <div class="mb-8 pl-10 relative"><div class="absolute -left-[10px] top-1 w-5 h-5 bg-teal-glow rounded-full border-2 border-navy-dark" style="box-shadow: 0 0 10px #14B8A6;"></div><p class="font-semibold text-lg">Penutupan</p><p class="text-sm text-light-text/70">07.00â€“08.00</p></div>
                    </div>
                </div>
            </div>
        </section>

        <!-- =========== REQUIREMENTS & PRICING SECTION =========== -->
        <section id="requirements" class="fade-in-section">
            <div class="max-w-5xl mx-auto grid md:grid-cols-5 gap-8 items-center card-glow p-8 md:p-12 rounded-2xl">
                <div class="md:col-span-3">
                    <h2 class="font-display text-3xl font-bold mb-6 uppercase">Persyaratan</h2>
                    <ul class="space-y-4 text-lg">
                        <li class="flex items-start"><svg class="w-7 h-7 text-lime-glow mr-3 mt-1 flex-shrink-0" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"></path></svg><span>Mengisi formulir pendaftaran online.</span></li>
                        <li class="flex items-start"><svg class="w-7 h-7 text-lime-glow mr-3 mt-1 flex-shrink-0" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"></path></svg><div class="flex-1"><span>Mendapatkan izin dari orang tua/wali.</span><button id="generate-permission-btn" class="mt-2 text-sm bg-magenta-glow/80 hover:bg-magenta-glow text-white px-3 py-1 rounded-full transition-all duration-300 font-semibold">âœ¨ Buat Draf Pesan Izin</button></div></li>
                        <li class="flex items-start"><svg class="w-7 h-7 text-lime-glow mr-3 mt-1 flex-shrink-0" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"></path></svg><span>Dalam kondisi sehat jasmani dan rohani.</span></li>
                    </ul>
                </div>
                <div class="md:col-span-2 bg-navy-dark/50 p-6 rounded-2xl border-l-4 border-lime-glow">
                    <h3 class="font-display text-2xl font-bold mb-4">Biaya Registrasi</h3>
                    <div class="space-y-3"><p class="text-lg"><span class="font-bold text-3xl">Rp15.000</span><br><span class="text-light-text/70">Pelajar Internal</span></p><p class="text-lg"><span class="font-bold text-3xl">Rp20.000</span><br><span class="text-light-text/70">Pelajar Eksternal</span></p></div>
                </div>
            </div>
        </section>

        <!-- =========== AI FAQ SECTION =========== -->
        <section class="fade-in-section">
            <div class="max-w-3xl mx-auto text-center card-glow p-8 rounded-2xl">
                 <h2 class="font-display text-3xl md:text-4xl font-bold text-center mb-4 uppercase">âœ¨ Punya Pertanyaan?</h2>
                 <p class="text-light-text/70 mb-6">Tanyakan pada Panitia AI kami! Ketik pertanyaanmu di bawah ini.</p>
                 <div class="flex flex-col sm:flex-row gap-2">
                     <input type="text" id="faq-input" placeholder="Contoh: Jam berapa pentas seni?" class="w-full px-4 py-3 bg-slate-800/60 border border-white/20 rounded-lg focus:ring-2 focus:ring-cyan-glow focus:outline-none placeholder-gray-500">
                     <button id="faq-submit-btn" class="bg-teal-glow text-white font-bold px-6 py-3 rounded-lg hover:bg-cyan-glow transition-colors">Tanya</button>
                 </div>
                 <div id="faq-response-container" class="mt-6 text-left p-4 bg-slate-800/60 rounded-lg" style="display: none;"><div id="faq-loader" class="flex justify-center items-center"><div class="loader"></div></div><p id="faq-response-text" class="whitespace-pre-wrap"></p></div>
            </div>
        </section>

        <!-- =========== CALL TO ACTION (CTA) SECTION =========== -->
        <section class="fade-in-section text-center py-16">
            <h2 class="font-display text-3xl md:text-4xl font-bold uppercase">Siap Menjadi Bagian dari Sejarah?</h2>
            <p class="text-light-text/70 mt-4 mb-8 max-w-xl mx-auto text-lg">Segera daftarkan dirimu dan jadilah kader militan yang siap berkontribusi untuk agama, nusa, dan bangsa.</p>
            <a href="https://forms.gle/YGah7SR9rofQ7SfcA" target="_blank" class="font-display inline-block bg-gradient-to-r from-teal-glow to-cyan-glow text-white font-bold text-xl px-12 py-4 rounded-2xl button-glow tracking-wider">DAFTAR SEKARANG</a>
        </section>
    </main>

    <!-- =========== FOOTER SECTION =========== -->
    <footer class="bg-black/20 text-white py-12 px-6">
        <div class="max-w-4xl mx-auto text-center"><h3 class="font-display text-2xl font-bold">Kontak Panitia</h3><p class="mt-4 text-light-text/60">Jika ada pertanyaan, hubungi kami:</p><div class="mt-6 flex flex-col md:flex-row justify-center items-center gap-y-4 md:gap-x-8"><span><strong>Rekan Hizkil</strong> (Ketua Panitia)</span><span><strong>HP/WA:</strong> 0812-4636-4091</span><span><strong>Email:</strong> rantingipnuippnupondoknongko@gmail.com</span></div><div class="mt-10 border-t border-white/20 pt-8 text-sm text-light-text/50"><p>&copy; 2025 Panitia Makesta IV | PR IPNU-IPPNU Pondoknongko.</p></div></div>
    </footer>

    <!-- =========== MODAL FOR GEMINI RESPONSE =========== -->
    <div id="permission-modal" class="modal-overlay fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center p-4 z-50 opacity-0 pointer-events-none">
        <div class="modal-container bg-slate-800 w-full max-w-lg p-6 rounded-2xl shadow-2xl border border-white/20 transform scale-95 opacity-0"><h2 class="font-display text-2xl font-bold text-light-text mb-4">Draf Pesan Izin untuk Orang Tua</h2><div id="modal-content"><div id="modal-loader" class="flex justify-center items-center py-8"><div class="loader"></div></div><div id="modal-response-container" style="display: none;"><p id="modal-response-text" class="text-light-text/90 bg-slate-900/70 p-4 rounded-lg whitespace-pre-wrap"></p><button id="copy-btn" class="mt-4 w-full bg-lime-glow text-navy-dark font-bold py-2 px-4 rounded-lg hover:bg-lime-300 transition-colors">Salin Teks</button></div></div><button id="close-modal-btn" class="mt-4 w-full bg-slate-700/70 text-light-text py-2 px-4 rounded-lg hover:bg-slate-600/70 transition-colors">Tutup</button></div>
    </div>


    <!-- JavaScript for Animations and Gemini API -->
    <script>
        document.addEventListener("DOMContentLoaded", function() {
            // --- Animation on Scroll ---
            const sections = document.querySelectorAll('.fade-in-section');
            const observer = new IntersectionObserver(entries => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        entry.target.classList.add('is-visible');
                        observer.unobserve(entry.target);
                    }
                });
            }, { threshold: 0.1 });
            sections.forEach(section => observer.observe(section));

            // --- Gemini API Integration ---
            const apiKey = "AIzaSyAgdzhIi-Oq6nb1PikkrsRLILIWPqLdtfg"; // API key is handled by the environment

            // --- Feature 1: Generate Permission Message ---
            const permissionBtn = document.getElementById('generate-permission-btn');
            const modal = document.getElementById('permission-modal');
            const closeModalBtn = document.getElementById('close-modal-btn');
            const modalLoader = document.getElementById('modal-loader');
            const modalResponseContainer = document.getElementById('modal-response-container');
            const modalResponseText = document.getElementById('modal-response-text');
            const copyBtn = document.getElementById('copy-btn');

            const showModal = () => {
                modal.classList.remove('opacity-0', 'pointer-events-none');
                modal.querySelector('.modal-container').classList.remove('scale-95', 'opacity-0');
            };

            const hideModal = () => {
                modal.classList.add('opacity-0');
                modal.querySelector('.modal-container').classList.add('scale-95', 'opacity-0');
                setTimeout(() => modal.classList.add('pointer-events-none'), 300);
            };

            permissionBtn.addEventListener('click', async () => {
                showModal();
                modalLoader.style.display = 'flex';
                modalResponseContainer.style.display = 'none';
                copyBtn.textContent = 'Salin Teks';

                const prompt = `Anda adalah seorang pelajar NU yang ingin meminta izin kepada orang tua untuk mengikuti acara Makesta IV (Masa Kesetiaan Anggota). Acara ini adalah kegiatan kaderisasi yang positif, diselenggarakan oleh PR IPNU-IPPNU Pondoknongko dengan tema 'Reaktualisasi Peran Pelajar NU Menuju Indonesia Emas 2045'. Kegiatannya meliputi materi ke-NU-an, keorganisasian, istigasah, dan fun games. Biayanya Rp15.000 untuk internal dan Rp20.000 untuk eksternal. Acara ini sangat bermanfaat untuk menambah ilmu dan teman. Buatkan draf pesan WhatsApp yang sopan, singkat, dan meyakinkan untuk saya kirimkan ke Ayah/Ibu. Mulai dengan salam.`;

                try {
                    const response = await callGemini(prompt);
                    modalResponseText.textContent = response;
                } catch (error) {
                    console.error("Error calling Gemini API:", error);
                    modalResponseText.textContent = `Maaf, terjadi kesalahan: ${error.message} Silakan coba lagi atau hubungi panitia.`;
                } finally {
                    modalLoader.style.display = 'none';
                    modalResponseContainer.style.display = 'block';
                }
            });
            
            closeModalBtn.addEventListener('click', hideModal);
            modal.addEventListener('click', (e) => {
                if (e.target === modal) hideModal();
            });

            copyBtn.addEventListener('click', () => {
                const textToCopy = modalResponseText.textContent;
                const tempTextArea = document.createElement('textarea');
                tempTextArea.value = textToCopy;
                document.body.appendChild(tempTextArea);
                tempTextArea.select();
                document.execCommand('copy');
                document.body.removeChild(tempTextArea);
                copyBtn.textContent = 'Berhasil Disalin!';
                setTimeout(() => { copyBtn.textContent = 'Salin Teks'; }, 2000);
            });

            // --- Feature 2: AI FAQ ---
            const faqInput = document.getElementById('faq-input');
            const faqSubmitBtn = document.getElementById('faq-submit-btn');
            const faqResponseContainer = document.getElementById('faq-response-container');
            const faqLoader = document.getElementById('faq-loader');
            const faqResponseText = document.getElementById('faq-response-text');
            
            const getPageContext = () => {
                 return `
                    Informasi Jadwal Detail Makesta IV 2025:
                    - Kontak Panitia: Rekan Hizkil (0812-4636-4091).
                    - Biaya: Rp15.000 (internal), Rp20.000 (eksternal).

                    - Jadwal Hari Sabtu, 12 Juli 2025:
                      - 08.00â€“09.00: Registrasi & pra acara
                      - 09.00â€“10.30: Seremonial pembukaan
                      - 10.30â€“11.00: Kontrak forum
                      - 11.00â€“11.45: Ishoma
                      - 11.45â€“14.45: Materi Ke-Aswajaan, Ke-NU-an, Ke-IPNU-IPPNU-an
                      - 14.45â€“15.15: Istirahat salat
                      - 15.15â€“17.15: Materi Ke-Indonesia-an, Keorganisasian
                      - 17.15â€“18.15: Istirahat salat & istigasah
                      - 18.15â€“19.15: Materi Kepemimpinan
                      - 20.00â€“22.00: Pentas seni
                      - 00.30â€“04.00: Pembaiatan

                    - Jadwal Hari Minggu, 13 Juli 2025:
                      - 04.00â€“05.00: Salat subuh
                      - 06.00â€“07.00: Fun game & sarapan
                      - 07.00â€“08.00: Penutupan
                `;
            }

            const handleFaqSubmit = async () => {
                const question = faqInput.value.trim();
                if (!question) return;

                faqResponseContainer.style.display = 'block';
                faqLoader.style.display = 'flex';
                faqResponseText.style.display = 'none';

                const context = getPageContext();
                const prompt = `Anda adalah Panitia AI untuk acara Makesta IV. Anda memiliki pengetahuan umum tentang IPNU-IPPNU dan Makesta (seperti pengertian, tujuan, tanggal lahir IPNU-IPPNU, urgensinya, dan lainnya), serta informasi detail acara di bawah ini.

                ATURAN PENTING:
                1. Jawab SEMUA pertanyaan dengan SINGKAT dan JELAS.
                2. Jika pertanyaan spesifik menanyakan "jam berapa" atau "kapan" suatu kegiatan dari jadwal, JAWAB HANYA DENGAN JAMNYA SAJA (Contoh: "Kapan pembaiatan?" -> "00.30â€“04.00").
                3. Untuk pertanyaan umum (seperti "apa itu Makesta?"), berikan jawaban singkat berdasarkan pengetahuan umum Anda tentang IPNU-IPPNU.
                4. Jika Anda benar-benar tidak tahu jawabannya, jawab dengan sopan bahwa Anda akan menanyakannya ke panitia lain dan arahkan untuk menghubungi kontak resmi.

                \n\n---\nInformasi Spesifik Acara:\n${context}\n---\nPertanyaan Peserta: "${question}"\n\nJawaban Anda:`;

                try {
                    const response = await callGemini(prompt);
                    faqResponseText.textContent = response;
                } catch (error) {
                    console.error("Error calling Gemini API for FAQ:", error);
                    faqResponseText.textContent = `Maaf, Panitia AI sedang istirahat. Terjadi kesalahan: ${error.message}. Silakan hubungi kontak panitia.`;
                } finally {
                    faqLoader.style.display = 'none';
                    faqResponseText.style.display = 'block';
                    faqInput.value = '';
                }
            };
            
            faqSubmitBtn.addEventListener('click', handleFaqSubmit);
            faqInput.addEventListener('keypress', (e) => {
                if(e.key === 'Enter') handleFaqSubmit();
            });

            // --- Reusable Gemini API Call Function ---
            async function callGemini(promptText) {
                const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=${apiKey}`;
                
                const payload = {
                    contents: [{
                        parts: [{ text: promptText }]
                    }],
                    generationConfig: {
                        temperature: 0.5,
                        maxOutputTokens: 250,
                    }
                };

                const response = await fetch(apiUrl, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(payload)
                });
                
                if (!response.ok) {
                    console.error("Gemini API HTTP Error:", await response.text());
                    throw new Error(`HTTP error! status: ${response.status}`);
                }

                const result = await response.json();
                
                if (result.candidates && result.candidates.length > 0 &&
                    result.candidates[0].content && result.candidates[0].content.parts &&
                    result.candidates[0].content.parts.length > 0 &&
                    result.candidates[0].content.parts[0].text) {
                    return result.candidates[0].content.parts[0].text;
                }
                
                if (result.promptFeedback && result.promptFeedback.blockReason) {
                    console.error("Request blocked by API:", result.promptFeedback);
                    return `Maaf, permintaan Anda tidak dapat diproses karena alasan keamanan (${result.promptFeedback.blockReason}). Coba gunakan pertanyaan atau kalimat yang berbeda.`;
                }

                console.error("Invalid response structure from Gemini API:", result);
                throw new Error("Gagal mendapatkan respons yang valid dari AI.");
            }
        });
    </script>

</body>
</html>
